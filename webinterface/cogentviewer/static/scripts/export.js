// Generated by CoffeeScript 1.6.3
require(["dijit/form/FilteringSelect", "dojo/store/Cache", "dojo/store/JsonRest", "dojo/store/Observable", "dojo/store/Memory", "dojo/dom", "dojo/query", "dojo/parser", "dojo/domReady!"], function(Select, Cache, JsonRest, Observable, Memory, dom, query, parser) {
  var houseChange, houseSelect, houseStore, radioChange, roomStore, updateRooms;
  console.log("Testing");
  houseStore = Cache(Observable(JsonRest({
    target: "./rest/house/"
  })), Memory());
  houseSelect = new Select({
    name: "houseId",
    store: houseStore,
    searchAttr: "address",
    onChange: function() {
      return houseChange();
    }
  }, "House");
  houseSelect.startup();
  roomStore = Cache(Observable(JsonRest({
    target: "./rest/houserooms/"
  })), Memory());
  houseChange = function() {
    var selectbox, theId;
    console.log("Select Changed");
    theId = houseSelect.get("value");
    selectbox = dom.byId("allsensors");
    console.log(selectbox);
    updateRooms(theId);
  };
  updateRooms = function(houseId) {
    var htmlStr;
    console.log("Id is ", houseId);
    htmlStr = "";
    roomStore.query({
      id: houseId
    }).forEach(function(item) {
      var rid, rname;
      console.log(item);
      rname = item['name'];
      rid = item['id'];
      return htmlStr += '<label class="checkbox inline"><input type="checkbox" name="locids" value="' + rid + '">' + rname + '</label>';
    }).then(function() {
      var theDiv;
      console.log(htmlStr);
      theDiv = dom.byId("roomGroup");
      console.log("Div ", theDiv);
      return theDiv.innerHTML = htmlStr;
    });
  };
  radioChange = function() {
    console.log("Radio Changed");
  };
});
